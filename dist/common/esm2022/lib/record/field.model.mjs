/**
 * SuiteCRM is a customer relationship management program developed by SalesAgility Ltd.
 * Copyright (C) 2021 SalesAgility Ltd.
 *
 * This program is free software; you can redistribute it and/or modify it under
 * the terms of the GNU Affero General Public License version 3 as published by the
 * Free Software Foundation with the addition of the following permission added
 * to Section 15 as permitted in Section 7(a): FOR ANY PART OF THE COVERED WORK
 * IN WHICH THE COPYRIGHT IS OWNED BY SALESAGILITY, SALESAGILITY DISCLAIMS THE
 * WARRANTY OF NON INFRINGEMENT OF THIRD PARTY RIGHTS.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more
 * details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * In accordance with Section 7(b) of the GNU Affero General Public License
 * version 3, these Appropriate Legal Notices must retain the display of the
 * "Supercharged by SuiteCRM" logo. If the display of the logos is not reasonably
 * feasible for technical reasons, the Appropriate Legal Notices must display
 * the words "Supercharged by SuiteCRM".
 */
import { BehaviorSubject } from 'rxjs';
export class BaseField {
    constructor() {
        this.fieldDependencies = {};
        this.attributeDependencies = [];
        this.defaultValueInitialized = false;
        this.valueSubject = new BehaviorSubject({});
        this.valueChanges$ = this.valueSubject.asObservable();
        this.loading = false;
    }
    get value() {
        return this.valueState;
    }
    set value(value) {
        const changed = value !== this.valueState;
        this.valueState = value;
        if (changed) {
            this.emitValueChanges();
        }
    }
    get valueList() {
        return this.valueListState;
    }
    set valueList(value) {
        this.valueListState = value;
        this.emitValueChanges();
    }
    get valueObject() {
        return this.valueObjectState;
    }
    set valueObject(value) {
        this.valueObjectState = value;
        this.emitValueChanges();
    }
    get valueObjectArray() {
        return this.valueObjectArrayState;
    }
    set valueObjectArray(value) {
        this.valueObjectArrayState = value;
        this.emitValueChanges();
    }
    emitValueChanges() {
        this.valueSubject.next({
            value: this.valueState,
            valueList: this.valueListState,
            valueObject: this.valueObjectState
        });
    }
    initDefaultValue() {
        if (this.defaultValueInitialized) {
            return;
        }
        const defaultValue = this?.default ?? this?.definition?.default ?? null;
        if (!this.value && defaultValue) {
            this.value = defaultValue;
            this?.formControl?.setValue(defaultValue);
            this.defaultValueInitialized = true;
        }
        else if (this.value === null) {
            this.value = '';
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmllbGQubW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9jb3JlL2FwcC9jb21tb24vc3JjL2xpYi9yZWNvcmQvZmllbGQubW9kZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQXdCRztBQUdILE9BQU8sRUFBQyxlQUFlLEVBQWEsTUFBTSxNQUFNLENBQUM7QUFtTGpELE1BQU0sT0FBTyxTQUFTO0lBbUNsQjtRQVhBLHNCQUFpQixHQUFjLEVBQUUsQ0FBQztRQUNsQywwQkFBcUIsR0FBMEIsRUFBRSxDQUFDO1FBUWxELDRCQUF1QixHQUFZLEtBQUssQ0FBQztRQUdyQyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksZUFBZSxDQUFhLEVBQWdCLENBQUMsQ0FBQztRQUN0RSxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDdEQsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7SUFDekIsQ0FBQztJQUVELElBQUksS0FBSztRQUNMLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUMzQixDQUFDO0lBRUQsSUFBSSxLQUFLLENBQUMsS0FBYTtRQUNuQixNQUFNLE9BQU8sR0FBRyxLQUFLLEtBQUssSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUUxQyxJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztRQUV4QixJQUFJLE9BQU8sRUFBRTtZQUNULElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1NBQzNCO0lBQ0wsQ0FBQztJQUVELElBQUksU0FBUztRQUNULE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQztJQUMvQixDQUFDO0lBRUQsSUFBSSxTQUFTLENBQUMsS0FBZTtRQUV6QixJQUFJLENBQUMsY0FBYyxHQUFHLEtBQUssQ0FBQztRQUU1QixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBRUQsSUFBSSxXQUFXO1FBQ1gsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7SUFDakMsQ0FBQztJQUVELElBQUksV0FBVyxDQUFDLEtBQVU7UUFDdEIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLEtBQUssQ0FBQztRQUM5QixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBRUQsSUFBSSxnQkFBZ0I7UUFDaEIsT0FBTyxJQUFJLENBQUMscUJBQXFCLENBQUM7SUFDdEMsQ0FBQztJQUVELElBQUksZ0JBQWdCLENBQUMsS0FBa0I7UUFDbkMsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEtBQUssQ0FBQztRQUNuQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBRVMsZ0JBQWdCO1FBQ3RCLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDO1lBQ25CLEtBQUssRUFBRSxJQUFJLENBQUMsVUFBVTtZQUN0QixTQUFTLEVBQUUsSUFBSSxDQUFDLGNBQWM7WUFDOUIsV0FBVyxFQUFFLElBQUksQ0FBQyxnQkFBZ0I7U0FDckMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztJQUVELGdCQUFnQjtRQUVaLElBQUksSUFBSSxDQUFDLHVCQUF1QixFQUFFO1lBQzlCLE9BQU87U0FDVjtRQUVELE1BQU0sWUFBWSxHQUFHLElBQUksRUFBRSxPQUFPLElBQUksSUFBSSxFQUFFLFVBQVUsRUFBRSxPQUFPLElBQUksSUFBSSxDQUFDO1FBQ3hFLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLFlBQVksRUFBRTtZQUM3QixJQUFJLENBQUMsS0FBSyxHQUFHLFlBQVksQ0FBQztZQUMxQixJQUFJLEVBQUUsV0FBVyxFQUFFLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUMxQyxJQUFJLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxDQUFDO1NBQ3ZDO2FBQU0sSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLElBQUksRUFBRTtZQUM1QixJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztTQUNuQjtJQUNMLENBQUM7Q0FFSiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3VpdGVDUk0gaXMgYSBjdXN0b21lciByZWxhdGlvbnNoaXAgbWFuYWdlbWVudCBwcm9ncmFtIGRldmVsb3BlZCBieSBTYWxlc0FnaWxpdHkgTHRkLlxuICogQ29weXJpZ2h0IChDKSAyMDIxIFNhbGVzQWdpbGl0eSBMdGQuXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQgdW5kZXJcbiAqIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEFmZmVybyBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIHZlcnNpb24gMyBhcyBwdWJsaXNoZWQgYnkgdGhlXG4gKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gd2l0aCB0aGUgYWRkaXRpb24gb2YgdGhlIGZvbGxvd2luZyBwZXJtaXNzaW9uIGFkZGVkXG4gKiB0byBTZWN0aW9uIDE1IGFzIHBlcm1pdHRlZCBpbiBTZWN0aW9uIDcoYSk6IEZPUiBBTlkgUEFSVCBPRiBUSEUgQ09WRVJFRCBXT1JLXG4gKiBJTiBXSElDSCBUSEUgQ09QWVJJR0hUIElTIE9XTkVEIEJZIFNBTEVTQUdJTElUWSwgU0FMRVNBR0lMSVRZIERJU0NMQUlNUyBUSEVcbiAqIFdBUlJBTlRZIE9GIE5PTiBJTkZSSU5HRU1FTlQgT0YgVEhJUkQgUEFSVFkgUklHSFRTLlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQgV0lUSE9VVFxuICogQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1NcbiAqIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gU2VlIHRoZSBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmVcbiAqIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEFmZmVybyBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG4gKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiAqXG4gKiBJbiBhY2NvcmRhbmNlIHdpdGggU2VjdGlvbiA3KGIpIG9mIHRoZSBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIHZlcnNpb24gMywgdGhlc2UgQXBwcm9wcmlhdGUgTGVnYWwgTm90aWNlcyBtdXN0IHJldGFpbiB0aGUgZGlzcGxheSBvZiB0aGVcbiAqIFwiU3VwZXJjaGFyZ2VkIGJ5IFN1aXRlQ1JNXCIgbG9nby4gSWYgdGhlIGRpc3BsYXkgb2YgdGhlIGxvZ29zIGlzIG5vdCByZWFzb25hYmx5XG4gKiBmZWFzaWJsZSBmb3IgdGVjaG5pY2FsIHJlYXNvbnMsIHRoZSBBcHByb3ByaWF0ZSBMZWdhbCBOb3RpY2VzIG11c3QgZGlzcGxheVxuICogdGhlIHdvcmRzIFwiU3VwZXJjaGFyZ2VkIGJ5IFN1aXRlQ1JNXCIuXG4gKi9cblxuaW1wb3J0IHtTZWFyY2hDcml0ZXJpYUZpZWxkRmlsdGVyfSBmcm9tICcuLi92aWV3cy9saXN0L3NlYXJjaC1jcml0ZXJpYS5tb2RlbCc7XG5pbXBvcnQge0JlaGF2aW9yU3ViamVjdCwgT2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0FzeW5jVmFsaWRhdG9yRm4sIFVudHlwZWRGb3JtQXJyYXksIFVudHlwZWRGb3JtQ29udHJvbCwgVmFsaWRhdG9yRm59IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7UmVjb3JkfSBmcm9tICcuL3JlY29yZC5tb2RlbCc7XG5pbXBvcnQge0ZpZWxkTG9naWNNYXB9IGZyb20gJy4uL2FjdGlvbnMvZmllbGQtbG9naWMtYWN0aW9uLm1vZGVsJztcbmltcG9ydCB7T2JqZWN0TWFwfSBmcm9tICcuLi90eXBlcy9vYmplY3QtbWFwJztcbmltcG9ydCB7Vmlld01vZGV9IGZyb20gJy4uL3ZpZXdzL3ZpZXcubW9kZWwnO1xuXG5leHBvcnQgdHlwZSBEaXNwbGF5VHlwZSA9ICdub25lJyB8ICdzaG93JyB8ICdyZWFkb25seScgfCAnaW5saW5lJyB8ICdkaXNhYmxlZCcgfCAnZGVmYXVsdCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3B0aW9uIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xuICAgIGxhYmVsPzogc3RyaW5nO1xuICAgIGxhYmVsS2V5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25EZWZpbml0aW9uIHtcbiAgICBba2V5OiBzdHJpbmddOiBudW1iZXIgfCBzdHJpbmc7XG5cbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgbWluPzogbnVtYmVyIHwgc3RyaW5nO1xuICAgIG1heD86IG51bWJlciB8IHN0cmluZztcbiAgICBjb21wYXJldG8/OiBzdHJpbmc7XG4gICAgYmxhbms/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGREZWZpbml0aW9uTWFwIHtcbiAgICBba2V5OiBzdHJpbmddOiBGaWVsZERlZmluaXRpb247XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGREZWZpbml0aW9uIHtcbiAgICBuYW1lPzogc3RyaW5nO1xuICAgIHR5cGU/OiBzdHJpbmc7IC8vIGxhYmVsIGtleSB0byB1c2VcbiAgICB2bmFtZT86IHN0cmluZzsgLy8gb3JpZ2luYWwgbGFiZWxcbiAgICBkeW5hbWljTGFiZWxLZXk/OiBzdHJpbmc7XG4gICAgb3B0aW9ucz86IHN0cmluZztcbiAgICByZXBvcnRhYmxlPzogYm9vbGVhbjtcbiAgICByZXF1aXJlZD86IGJvb2xlYW47XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGR1cGxpY2F0ZV9tZXJnZT86IHN0cmluZztcbiAgICBzb3VyY2U/OiBzdHJpbmc7XG4gICAgaWQ/OiBzdHJpbmc7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGlkX25hbWU/OiBzdHJpbmc7XG4gICAgbGluaz86IHN0cmluZztcbiAgICBtb2R1bGU/OiBzdHJpbmc7XG4gICAgdHlwZV9uYW1lPzogc3RyaW5nO1xuICAgIHJuYW1lPzogc3RyaW5nO1xuICAgIHRhYmxlPzogc3RyaW5nO1xuICAgIHJlYWRvbmx5PzogYm9vbGVhbjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgaW5saW5lX2VkaXQ/OiBib29sZWFuO1xuICAgIHZhbGlkYXRpb24/OiBWYWxpZGF0aW9uRGVmaW5pdGlvbjtcbiAgICB2YWxpZGF0aW9ucz86IFZhbGlkYXRpb25EZWZpbml0aW9uW107XG4gICAgdGVtcGxhdGU/OiBzdHJpbmc7XG4gICAgZGlzcGxheT86IHN0cmluZztcbiAgICBkaXNwbGF5VHlwZT86IHN0cmluZztcbiAgICBkaXNwbGF5RGlyZWN0aW9uPzogc3RyaW5nO1xuICAgIGxheW91dD86IHN0cmluZ1tdO1xuICAgIHNob3dMYWJlbD86IGFueTtcbiAgICBncm91cEZpZWxkcz86IEZpZWxkRGVmaW5pdGlvbk1hcDtcbiAgICBhdHRyaWJ1dGVGaWVsZHM/OiBGaWVsZERlZmluaXRpb25NYXA7XG4gICAgdmFsdWVQYXRoPzogc3RyaW5nO1xuICAgIHZhbHVlUGFyZW50Pzogc3RyaW5nO1xuICAgIGR5bmFtaWM/OiBib29sZWFuO1xuICAgIHBhcmVudGVudW0/OiBzdHJpbmc7XG4gICAgbG9naWM/OiBGaWVsZExvZ2ljTWFwO1xuICAgIGRpc3BsYXlMb2dpYz86IEZpZWxkTG9naWNNYXA7XG4gICAgbGluZUl0ZW1zPzogTGluZUl0ZW1zTWV0YWRhdGE7XG4gICAgbWV0YWRhdGE/OiBGaWVsZE1ldGFkYXRhO1xuICAgIGRlZmF1bHQ/OiBzdHJpbmc7XG4gICAgZGVmYXVsdFZhbHVlTW9kZXM/OiBWaWV3TW9kZVtdO1xuICAgIG1vZGVzPzogVmlld01vZGVbXTtcbiAgICByZWxhdGlvbnNoaXA/OiBzdHJpbmc7XG4gICAgcmVsYXRpb25zaGlwTWV0YWRhdGE/OiBSZWxhdGlvbnNoaXBNZXRhZGF0YVxuXG4gICAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlbGF0aW9uc2hpcE1ldGFkYXRhIHtcbiAgICBzaWRlOiBzdHJpbmc7XG4gICAgcmVsYXRlZF9pZD86IHN0cmluZztcbiAgICB0eXBlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGluZUl0ZW1zTWV0YWRhdGEge1xuICAgIGRlZmluaXRpb246IEZpZWxkRGVmaW5pdGlvbjtcbiAgICBsYWJlbE9uRmlyc3RMaW5lPzogYm9vbGVhbjtcblxuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuZXhwb3J0IGRlY2xhcmUgdHlwZSBGaWVsZENsaWNrQ2FsbGJhY2sgPSAoZmllbGQ6IEZpZWxkLCByZWNvcmQ6IFJlY29yZCkgPT4gdm9pZDtcblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZE1ldGFkYXRhIHtcbiAgICBmb3JtYXQ/OiBib29sZWFuO1xuICAgIHRhcmdldD86IHN0cmluZztcbiAgICBsaW5rPzogYm9vbGVhbjtcbiAgICBsaW5rUm91dGU/OiBzdHJpbmc7XG4gICAgbGlua0FzeW5jQWN0aW9uPzogc3RyaW5nO1xuICAgIHJvd3M/OiBudW1iZXI7XG4gICAgY29scz86IG51bWJlcjtcbiAgICBkaWdpdHM/OiBudW1iZXI7XG4gICAgaXNCYXNlQ3VycmVuY3k/OiBib29sZWFuO1xuICAgIGxhYmVsRGlzcGxheT86IHN0cmluZztcbiAgICBvcHRpb25zJD86IE9ic2VydmFibGU8T3B0aW9uW10+O1xuICAgIGV4dHJhT3B0aW9ucz86IE9wdGlvbltdO1xuICAgIG9uQ2xpY2s/OiBGaWVsZENsaWNrQ2FsbGJhY2s7XG4gICAgdGlueW1jZT86IGFueTtcbiAgICBkYXRlX3RpbWVfZm9ybWF0Pzogc3RyaW5nO1xuICAgIGRpc3BsYXlMb2dpY1Jlc2V0T24/OiBzdHJpbmc7XG4gICAgcmVsYXRlU2VhcmNoRmllbGQ/OiBzdHJpbmc7XG5cblxuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZEF0dHJpYnV0ZU1hcCB7XG4gICAgW2tleTogc3RyaW5nXTogRmllbGRBdHRyaWJ1dGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGRBdHRyaWJ1dGUgZXh0ZW5kcyBGaWVsZCB7XG4gICAgdmFsdWVQYXRoPzogc3RyaW5nO1xuICAgIHZhbHVlUGFyZW50Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkTWFwIHtcbiAgICBba2V5OiBzdHJpbmddOiBGaWVsZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBdHRyaWJ1dGVEZXBlbmRlbmN5IHtcbiAgICBmaWVsZDogc3RyaW5nO1xuICAgIGF0dHJpYnV0ZTogc3RyaW5nO1xuICAgIHR5cGVzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IHR5cGUgRmllbGRTb3VyY2UgPSAnZmllbGQnIHwgJ2F0dHJpYnV0ZScgfCAnaXRlbScgfCAnZ3JvdXBGaWVsZCc7XG5cbmV4cG9ydCBkZWNsYXJlIHR5cGUgRGVmYXVsdFZhbHVlSW5pdENhbGxiYWNrID0gKCkgPT4gdm9pZDtcblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZCB7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIHZhbHVlPzogc3RyaW5nO1xuICAgIHZhbHVlTGlzdD86IHN0cmluZ1tdO1xuICAgIHZhbHVlT2JqZWN0PzogYW55O1xuICAgIHZhbHVlT2JqZWN0QXJyYXk/OiBPYmplY3RNYXBbXTtcbiAgICBuYW1lPzogc3RyaW5nO1xuICAgIHZhcmRlZkJhc2VkPzogYm9vbGVhbjtcbiAgICBsYWJlbD86IHN0cmluZztcbiAgICBsYWJlbEtleT86IHN0cmluZztcbiAgICBsb2FkaW5nPzogYm9vbGVhbjtcbiAgICBkeW5hbWljTGFiZWxLZXk/OiBzdHJpbmc7XG4gICAgcGFyZW50S2V5Pzogc3RyaW5nO1xuICAgIGF0dHJpYnV0ZXM/OiBGaWVsZEF0dHJpYnV0ZU1hcDtcbiAgICBpdGVtcz86IFJlY29yZFtdO1xuICAgIHJlYWRvbmx5PzogYm9vbGVhbjtcbiAgICBkaXNwbGF5PzogRGlzcGxheVR5cGU7XG4gICAgZGVmYXVsdERpc3BsYXk/OiBzdHJpbmc7XG4gICAgZGVmYXVsdD86IHN0cmluZztcbiAgICBkZWZhdWx0VmFsdWVNb2Rlcz86IFZpZXdNb2RlW107XG4gICAgc291cmNlPzogRmllbGRTb3VyY2U7XG4gICAgdmFsdWVTb3VyY2U/OiAndmFsdWUnIHwgJ3ZhbHVlTGlzdCcgfCAndmFsdWVPYmplY3QnIHwgJ2NyaXRlcmlhJztcbiAgICBtZXRhZGF0YT86IEZpZWxkTWV0YWRhdGE7XG4gICAgZGVmaW5pdGlvbj86IEZpZWxkRGVmaW5pdGlvbjtcbiAgICBjcml0ZXJpYT86IFNlYXJjaENyaXRlcmlhRmllbGRGaWx0ZXI7XG4gICAgZm9ybUNvbnRyb2w/OiBVbnR5cGVkRm9ybUNvbnRyb2w7XG4gICAgaXRlbUZvcm1BcnJheT86IFVudHlwZWRGb3JtQXJyYXk7XG4gICAgdmFsaWRhdG9ycz86IFZhbGlkYXRvckZuW107XG4gICAgYXN5bmNWYWxpZGF0b3JzPzogQXN5bmNWYWxpZGF0b3JGbltdO1xuICAgIHZhbHVlU3ViamVjdD86IEJlaGF2aW9yU3ViamVjdDxGaWVsZFZhbHVlPjtcbiAgICB2YWx1ZUNoYW5nZXMkPzogT2JzZXJ2YWJsZTxGaWVsZFZhbHVlPjtcbiAgICBmaWVsZERlcGVuZGVuY2llcz86IE9iamVjdE1hcDtcbiAgICBhdHRyaWJ1dGVEZXBlbmRlbmNpZXM/OiBBdHRyaWJ1dGVEZXBlbmRlbmN5W107XG4gICAgbG9naWM/OiBGaWVsZExvZ2ljTWFwO1xuICAgIGRpc3BsYXlMb2dpYz86IEZpZWxkTG9naWNNYXA7XG4gICAgcHJldmlvdXNWYWx1ZT86IHN0cmluZztcblxuICAgIGluaXREZWZhdWx0VmFsdWU/OiBEZWZhdWx0VmFsdWVJbml0Q2FsbGJhY2s7XG59XG5cbmV4cG9ydCBjbGFzcyBCYXNlRmllbGQgaW1wbGVtZW50cyBGaWVsZCB7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIG5hbWU/OiBzdHJpbmc7XG4gICAgdmFyZGVmQmFzZWQ/OiBib29sZWFuO1xuICAgIGxhYmVsPzogc3RyaW5nO1xuICAgIGxhYmVsS2V5Pzogc3RyaW5nO1xuICAgIGxvYWRpbmc/OiBib29sZWFuO1xuICAgIGR5bmFtaWNMYWJlbEtleT86IHN0cmluZztcbiAgICByZWFkb25seT86IGJvb2xlYW47XG4gICAgZGlzcGxheT86IERpc3BsYXlUeXBlO1xuICAgIGRlZmF1bHREaXNwbGF5Pzogc3RyaW5nO1xuICAgIGRlZmF1bHQ/OiBzdHJpbmc7XG4gICAgZGVmYXVsdFZhbHVlTW9kZXM/OiBWaWV3TW9kZVtdO1xuICAgIHNvdXJjZT86IEZpZWxkU291cmNlO1xuICAgIG1ldGFkYXRhPzogRmllbGRNZXRhZGF0YTtcbiAgICBkZWZpbml0aW9uPzogRmllbGREZWZpbml0aW9uO1xuICAgIGNyaXRlcmlhPzogU2VhcmNoQ3JpdGVyaWFGaWVsZEZpbHRlcjtcbiAgICBmb3JtQ29udHJvbD86IFVudHlwZWRGb3JtQ29udHJvbDtcbiAgICBpdGVtRm9ybUFycmF5PzogVW50eXBlZEZvcm1BcnJheTtcbiAgICB2YWxpZGF0b3JzPzogVmFsaWRhdG9yRm5bXTtcbiAgICBhc3luY1ZhbGlkYXRvcnM/OiBBc3luY1ZhbGlkYXRvckZuW107XG4gICAgYXR0cmlidXRlcz86IEZpZWxkQXR0cmlidXRlTWFwO1xuICAgIHZhbHVlU3ViamVjdD86IEJlaGF2aW9yU3ViamVjdDxGaWVsZFZhbHVlPjtcbiAgICB2YWx1ZUNoYW5nZXMkPzogT2JzZXJ2YWJsZTxGaWVsZFZhbHVlPjtcbiAgICBmaWVsZERlcGVuZGVuY2llczogT2JqZWN0TWFwID0ge307XG4gICAgYXR0cmlidXRlRGVwZW5kZW5jaWVzOiBBdHRyaWJ1dGVEZXBlbmRlbmN5W10gPSBbXTtcbiAgICBsb2dpYz86IEZpZWxkTG9naWNNYXA7XG4gICAgZGlzcGxheUxvZ2ljPzogRmllbGRMb2dpY01hcDtcblxuICAgIHByb3RlY3RlZCB2YWx1ZVN0YXRlPzogc3RyaW5nO1xuICAgIHByb3RlY3RlZCB2YWx1ZUxpc3RTdGF0ZT86IHN0cmluZ1tdO1xuICAgIHByb3RlY3RlZCB2YWx1ZU9iamVjdFN0YXRlPzogYW55O1xuICAgIHByb3RlY3RlZCB2YWx1ZU9iamVjdEFycmF5U3RhdGU/OiBPYmplY3RNYXBbXTtcbiAgICBkZWZhdWx0VmFsdWVJbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudmFsdWVTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxGaWVsZFZhbHVlPih7fSBhcyBGaWVsZFZhbHVlKTtcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZXMkID0gdGhpcy52YWx1ZVN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIGdldCB2YWx1ZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZVN0YXRlO1xuICAgIH1cblxuICAgIHNldCB2YWx1ZSh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGNoYW5nZWQgPSB2YWx1ZSAhPT0gdGhpcy52YWx1ZVN0YXRlO1xuXG4gICAgICAgIHRoaXMudmFsdWVTdGF0ZSA9IHZhbHVlO1xuXG4gICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZXMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCB2YWx1ZUxpc3QoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUxpc3RTdGF0ZTtcbiAgICB9XG5cbiAgICBzZXQgdmFsdWVMaXN0KHZhbHVlOiBzdHJpbmdbXSkge1xuXG4gICAgICAgIHRoaXMudmFsdWVMaXN0U3RhdGUgPSB2YWx1ZTtcblxuICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZXMoKTtcbiAgICB9XG5cbiAgICBnZXQgdmFsdWVPYmplY3QoKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVPYmplY3RTdGF0ZTtcbiAgICB9XG5cbiAgICBzZXQgdmFsdWVPYmplY3QodmFsdWU6IGFueSkge1xuICAgICAgICB0aGlzLnZhbHVlT2JqZWN0U3RhdGUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgZ2V0IHZhbHVlT2JqZWN0QXJyYXkoKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVPYmplY3RBcnJheVN0YXRlO1xuICAgIH1cblxuICAgIHNldCB2YWx1ZU9iamVjdEFycmF5KHZhbHVlOiBPYmplY3RNYXBbXSkge1xuICAgICAgICB0aGlzLnZhbHVlT2JqZWN0QXJyYXlTdGF0ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZXMoKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZW1pdFZhbHVlQ2hhbmdlcygpIHtcbiAgICAgICAgdGhpcy52YWx1ZVN1YmplY3QubmV4dCh7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZVN0YXRlLFxuICAgICAgICAgICAgdmFsdWVMaXN0OiB0aGlzLnZhbHVlTGlzdFN0YXRlLFxuICAgICAgICAgICAgdmFsdWVPYmplY3Q6IHRoaXMudmFsdWVPYmplY3RTdGF0ZVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGluaXREZWZhdWx0VmFsdWUoKTogdm9pZCB7XG5cbiAgICAgICAgaWYgKHRoaXMuZGVmYXVsdFZhbHVlSW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IHRoaXM/LmRlZmF1bHQgPz8gdGhpcz8uZGVmaW5pdGlvbj8uZGVmYXVsdCA/PyBudWxsO1xuICAgICAgICBpZiAoIXRoaXMudmFsdWUgJiYgZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdGhpcz8uZm9ybUNvbnRyb2w/LnNldFZhbHVlKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZUluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZFZhbHVlIHtcbiAgICB2YWx1ZT86IHN0cmluZztcbiAgICB2YWx1ZUxpc3Q/OiBzdHJpbmdbXTtcbiAgICB2YWx1ZU9iamVjdD86IGFueTtcbn1cblxuXG4iXX0=